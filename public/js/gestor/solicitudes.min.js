"use strict";class Ajax{callController(parameter,callBackFunction){$.ajax({url:"../app/controller/ajax.php",type:"POST",data:parameter,dataType:"json",success:function(callBackData){eval(callBackFunction+"(callBackData)")},error:function(a,typeError,textError){let error0='{"errMessage": "Se ha producido un error en la conexion", "errCodeException": "", "errMessageException": "" }',error1='{"errMessage": "Se ha producido un error en la conexion", "errCodeException":"'+typeError+'", "errMessageException":"'+textError+'"}';eval(callBackFunction+'({"succes": false, "errores": ['+error0+","+error1+"]})")}})}}class Solicitudes{getParameterSearchSolicitudes(){return"action=searchSolicitudes&"+$("#formSearch").serialize()}getParameterAceptarSolicitud(a){return"action=aceptarSolicitud&usuario="+$("#usuario").val()+"&cod_solicitud="+a.target.name.split("-")[1]}getParameterCancelarSolicitud(a){return"action=cancelarSolicitud&usuario="+$("#usuario").val()+"&cod_solicitud="+a.target.name.split("-")[1]}}var solicitudesApp=new Solicitudes,ajaxApp=new Ajax,solicitudes="";function addEventsSolicitudes(){$("#search").click(search)}function addEventsDetalles(a){for(let e=0;e<a.length;e++)$("#detalles-"+a[e].cod_solicitud).off(),$("#detalles-"+a[e].cod_solicitud).click(showSolicitud)}function addEventsAcceptar(){for(let a=0;a<solicitudes.length;a++)$("#aceptar-"+solicitudes[a].cod_solicitud).off(),$("#aceptar-"+solicitudes[a].cod_solicitud).click(aceptarSolicitud)}function addEventsCancelar(){for(let a=0;a<solicitudes.length;a++)$("#cancelar-"+solicitudes[a].cod_solicitud).off(),$("#cancelar-"+solicitudes[a].cod_solicitud).click(cancelarSolicitud)}function search(){ajaxApp.callController(solicitudesApp.getParameterSearchSolicitudes(),"callBackSearchSolicitudes")}function callBackSearchSolicitudes(a){a.success?(cleanTbody(),solicitudes=a.solicitudes,0!==a.solicitudes.length&&(injectSolicitudes(a.solicitudes),addEventsDetalles(a.solicitudes),addEventsAcceptar(a.solicitudes),addEventsCancelar(a.solicitudes))):msjDanger("SOLICITUDES",a.errores[0].errMessage)}function showSolicitud(a){for(let e=0;e<solicitudes.length;e++)solicitudes[e].cod_solicitud===a.target.name.split("-")[1]&&injectDetalles(solicitudes[e])}function aceptarSolicitud(a){ajaxApp.callController(solicitudesApp.getParameterAceptarSolicitud(a),"callBackAceptarSolicitudes")}function callBackAceptarSolicitudes(a){a.success?(msjSucces("SOLICITUDES","<strong>Se acepto la solicitud correctamente</strong>"),cleanTbody()):msjDanger("SOLICITUDES",a.errores[0].errMessage)}function cancelarSolicitud(a){ajaxApp.callController(solicitudesApp.getParameterCancelarSolicitud(a),"callBackCancelarSolicitudes")}function callBackCancelarSolicitudes(a){a.success?(msjSucces("SOLICITUDES","<strong>Se cancelo la solicitud correctamente</strong>"),cleanTbody()):msjDanger("SOLICITUDES",a.errores[0].errMessage)}function msjDanger(a,e){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="danger" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-danger"><h1>'+a+'</h1></div><div class="modal-body">'+e+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#danger").modal("show")}function msjWarning(a,e){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="warning" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-warning"><h1>'+a+'</h1></div><div class="modal-body">'+e+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#warning").modal("show")}function msjSucces(a,e){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="success" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-success"><h1>'+a+'</h1></div><div class="modal-body">'+e+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#success").modal("show")}function msjInfo(a,e){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="info" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-info"><h1>'+a+'</h1></div><div class="modal-body">'+e+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#info").modal("show")}function cleanTbody(){$("#tbody").empty()}function injectSolicitudes(a){for(let e=0;e<a.length;e++)$("#tbody").append("<tr><td>"+a[e].cif_dni+"</td><td>"+a[e].nombre_completo+"</td><td>"+a[e].razon_social+'</td><td><input type="button"  id="detalles-'+a[e].cod_solicitud+'" name="detalles-'+a[e].cod_solicitud+'" value="Detalles" class="btn btn-primary btn-block"></td><td><input type="button"  id="aceptar-'+a[e].cod_solicitud+'" name="aceptar-'+a[e].cod_solicitud+'" value="Aceptar" class="btn btn-warning btn-block"></td><td><input type="button"  id="cancelar-'+a[e].cod_solicitud+'" name="cancelar-'+a[e].cod_solicitud+'" value="Cancelar" class="btn btn-danger btn-block"></td></tr>')}function injectDetalles(a){msjInfo("SOLICITUD",'<div class="table-responsive"><table class="table table-hover"><thead><tr><th>domicilio_social</th><th>ciudad</th><th>email</th><th>telefono</th><th>nick</th><th>password</th></tr></thead><tbody><tr><td>'+a.domicilio_social+"</td><td>"+a.ciudad+"</td><td>"+a.email+"</td><td>"+a.telefono+"</td><td>"+a.nick+"</td><td>"+a.password+"</td></tr></tbody></table></div>")}document.onload=addEventsSolicitudes();