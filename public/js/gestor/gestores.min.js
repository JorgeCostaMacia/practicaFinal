class Ajax{callController(parameter,callBackFunction){$.ajax({url:"../app/controller/ajax.php",type:"POST",data:parameter,dataType:"json",success:function(callBackData){eval(callBackFunction+"(callBackData)")},error:function(a,typeError,textError){let error0='{"errMessage": "Se ha producido un error en la conexion", "errCodeException": "", "errMessageException": "" }',error1='{"errMessage": "Se ha producido un error en la conexion", "errCodeException":"'+typeError+'", "errMessageException":"'+textError+'"}';eval(callBackFunction+'({"succes": false, "errores": ['+error0+","+error1+"]})")}})}}class Gestores{getParameterSearchGestores(){return"action=searchGestores&"+$("#formSearch").serialize()}evalInputsUpdate(){let e=[];return e.succes=!0,e.errores=[],e.errores.pass=!0,validatePassLogin($("#passReg").val())||(e.succes=!1,e.errores.pass=!1),e}getParameterUpdate(){return"action=updateGestor&"+$("#formGetAccount").serialize()}getTextErrorUpdate(e){let t="";return e.pass||(t+="<strong>Formato de password incorrecto</strong><br>",t+="Solo admite letras<br>",t+="Ha de contener al menos 5 caracteres<br>"),t}}function search(){cleanTbody(),restoreGestores(),delEventsSig(),delEventsAnt(),$("#numPage").val(1),injectPageNumber(),ajaxApp.callController(gestoresApp.getParameterSearchGestores(),"callBackSearchGestores")}function callBackSearchGestores(e){e.success?0!==e.usuarios_gestion.length&&(gestores=e.usuarios_gestion,injectGestores(e.usuarios_gestion),addEventsModificar(e.usuarios_gestion),addEventsSiguiente()):msjDanger("GESTORES",e.errores[0].errMessage)}function searchSiguiente(){restoreClientes(),delEventsSig(),delEventsAnt(),$("#numPage").val(1*$("#numPage").val()+1),ajaxApp.callController(gestoresApp.getParameterSearchGestores(),"callBackSearchSiguiente")}function callBackSearchSiguiente(e){e.success?(0!==e.usuarios_gestion.length?(gestores=e.usuarios_gestion,cleanTbody(),injectGestores(e.v),addEventsModificar(e.usuarios_gestion),addEventsSiguiente()):$("#numPage").val(1*$("#numPage").val()-1),"1"!==$("#numPage").val()&&addEventsAnterior(),injectPageNumber()):msjDanger("GESTORES",e.errores[0].errMessage)}function searchAnterior(){restoreGestores(),delEventsSig(),delEventsAnt(),$("#numPage").val(1*$("#numPage").val()-1),ajaxApp.callController(gestoresApp.getParameterSearchGestores(),"callBackSearchAnterior")}function callBackSearchAnterior(e){e.success?(cleanTbody(),injectClientes(e.usuarios_gestion),addEventsModificar(e.usuarios_gestion),addEventsSiguiente(),"1"!==$("#numPage").val()&&addEventsAnterior(),injectPageNumber()):msjDanger("GESTORES",e.errores[0].errMessage)}function showGestores(e){cleanModificar();for(let e=0;e<gestores.length;e++)gestores[e].cod_gestor===this.id.split("-")[1]&&(injectModificar(gestores[e]),addEventsUpdate())}function evalModificar(){let e=gestoresApp.evalInputsUpdate();e.succes?ajaxApp.callController(gestoresApp.getParameterUpdate(),"callBackEvalUpdate"):msjDanger("GESTORES",clientesApp.getTextErrorUpdate(e.errores))}function callBackEvalUpdate(e){e.success?(msjSucces("GESTORES","<strong>Se ha modificado correctamente</strong>"),cleanTbody(),restoreGestores()):msjDanger("GESTORES",e.errores[0].errMessage)}var gestoresApp=new Gestores,ajaxApp=new Ajax,gestores="";function addEventsGestores(){$("#search").click(search)}function addEventsSiguiente(){$("#siguiente").click(searchSiguiente)}function addEventsAnterior(){$("#anterior").click(searchAnterior)}function delEventsSig(){$("#siguiente").off()}function delEventsAnt(){$("#anterior").off()}function addEventsModificar(e){for(let t=0;t<e.length;t++)$("#modificar-"+gestores[t].cod_gestor).off(),$("#modificar-"+gestores[t].cod_gestor).click(showGestores)}function addEventsUpdate(){$(document).off("click","#updateGestor"),$(document).off("click","#buttonVolver"),$(document).on("click","#updateGestor",evalModificar),$(document).on("click","#buttonVolver",restoreGestores)}function validatePassLogin(e){return esTexto(e)&&e.length>=5}function esTexto(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esLetra(e[o])||(t=!1,o=e.length);else t=!1;return t}function esTextoNumero(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esLetra(e[o])||esNumeros(e[o])||(t=!1,o=e.length);else t=!1;return t}function esTextoEspacio(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esLetra(e[o])||esEspacio(e[o])||(t=!1,o=e.length);else t=!1;return t}function esNumeroMas(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esNumero(e[o])||esMas(e[o])||(t=!1,o=e.length);else t=!1;return t}function esNumeroGuion(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esNumero(e[o])||esGuion(e[o])||(t=!1,o=e.length);else t=!1;return t}function esNumeros(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esNumero(e[o])||(t=!1,o=e.length);else t=!1;return t}function esTextoEspacioPuntoComaBarraNumero(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esTexto(e[o])||esEspacio(e[o])||esPunto(e[o])||esComa(e[o])||esNumero(e[o])||esBarra(e[o])||(t=!1,o=e.length);else t=!1;return t}function esTextoPunto(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esTexto(e[o])||esPunto(e[o])||(t=!1,o=e.length);else t=!1;return t}function esTextoBarra(e){let t=!0;if(""!==e&&null!==e)for(let o=0;o<e.length;o++)esTexto(e[o])||esPunto(e[o])||(t=!1,o=e.length);else t=!1;return t}function esNumeroPositivoEntero(e){return parseInt(e)&&esPositivo(e)&&esEntero(e)}function esLetra(e){return e.charCodeAt()>64&&e.charCodeAt()<91||165===e.charCodeAt()||164===e.charCodeAt()||e.charCodeAt()>96&&e.charCodeAt()<123}function esEspacio(e){return 32===e.charCodeAt()}function esNumero(e){return e.charCodeAt()>47&&e.charCodeAt()<58}function esPositivo(e){return parseInt(e)>0}function esEntero(e){return parseInt(e)%1==0}function esGuion(e){return 45===e.charCodeAt()}function esPunto(e){return 46===e.charCodeAt()}function esComa(e){return 44===e.charCodeAt()}function esContBarra(e){return 47===e.charCodeAt()}function esBarra(e){return 92===e.charCodeAt()}function esMas(e){return 43===e.charCodeAt()}function cleanTbody(){$("#tbody").empty()}function restoreGestores(){$("#tableModificar").empty(),$("#tableGestores").attr("hidden",!1)}function cleanModificar(){$("#tableModificar").empty()}function injectGestores(e){for(let t=0;t<e.length;t++)$("#tbody").append("<tr><td>"+e[t].cod_gestor+"</td><td>"+e[t].nombre_completo+"</td><td>"+e[t].nick+'</td><td><button type="button" id="modificar-'+e[t].cod_gestor+'" value="'+e[t].cod_gestor+'" class="form-control btn-warning">Modificar</td></td></tr>')}function injectPageNumber(){$("#pageActual").empty(),$("#pageActual").append($("#numPage").val())}function injectModificar(e){let t='<form id="formGetAccount" method="POST"><input type="hidden" id="usuario" name="usuario" value="gestor"><input type="hidden" name="cod_gestor" value="'+e.cod_gestor+'"><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="input-group input-group-lg"><span class="input-group-addon "><span class="glyphicon glyphicon-user"></span></span><input type="text" name="cod_gestor" id="cod_gestor" maxlength="30" class="form-control" placeholder="Nick" aria-describedby="sizing-addon1" value="'+e.cod_gestor+'" disabled></div><br></div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="input-group input-group-lg"><span class="input-group-addon "><span class="glyphicon glyphicon-user"></span></span><input type="text" name="nick" id="nickReg" maxlength="30" class="form-control" placeholder="Nick" aria-describedby="sizing-addon1" value="'+e.nick+'" disabled></div><br></div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="input-group input-group-lg"><span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span><input type="password" name="password" id="passReg" maxlength="30" class="form-control" placeholder="Password" value="'+e.password+'" required></div><br/></div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="input-group input-group-lg"><span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span><input type="text" name="nombre_completo" id="nombre_completo" maxlength="30" class="form-control" placeholder="Nombre completo" value="'+e.nombre_completo+'" disabled></div><br></div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="input-group input-group-lg"><span class="input-group-addon"><span class="glyphicon glyphicon-cog"></span></span><select name="estado" id="estado" class="form-control">';"activo"===e.estado?(t+='<option value="activo" selected>Activo</option>',t+='<option value="inactivo">Inactivo</option>'):(t+='<option value="activo">Activo</option>',t+='<option value="inactivo" selected>Inactivo</option>'),t+='</select></div><br></div><div class="col-lg-12"><button type="button" name="updateGestor" id="updateGestor" class="btn btn-warning btn-block">Modificar</button><button type="button" id="buttonVolver" name="buttonVolver" class="btn btn-primary btn-block">Volver gestores</button></div></form>',$("#tableGestores").attr("hidden",!0),$("#tableModificar").append(t)}function msjDanger(e,t){let o=Math.floor(1e16*Math.random()+1);$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="danger'+o+'" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-danger"><h1>'+e+'</h1></div><div class="modal-body">'+t+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#danger"+o).modal("show")}function msjWarning(e,t){let o=Math.floor(1e16*Math.random()+1);$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="warning'+o+'" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-warning"><h1>'+e+'</h1></div><div class="modal-body">'+t+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#warning"+o).modal("show")}function msjSucces(e,t){let o=Math.floor(1e16*Math.random()+1);$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="success'+o+'" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-success"><h1>'+e+'</h1></div><div class="modal-body">'+t+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#success"+o).modal("show")}function msjInfo(e,t){let o=Math.floor(1e16*Math.random()+1);$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="info'+o+'" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-info"><h1>'+e+'</h1></div><div class="modal-body">'+t+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#info"+o).modal("show")}document.onload=addEventsGestores();