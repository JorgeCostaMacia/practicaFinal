"use strict";class Ajax{callController(parameter,callBackFunction){$.ajax({url:"../app/controller/ajax.php",type:"POST",data:parameter,dataType:"json",success:function(callBackData){eval(callBackFunction+"(callBackData)")},error:function(a,typeError,textError){let error0='{"errMessage": "Se ha producido un error en la conexion", "errCodeException": "", "errMessageException": "" }',error1='{"errMessage": "Se ha producido un error en la conexion", "errCodeException":"'+typeError+'", "errMessageException":"'+textError+'"}';eval(callBackFunction+'({"succes": false, "errores": ['+error0+","+error1+"]})")}})}}class RealizarPedidosCliente{getParameterSearchArticulos(){let e="action=searchArticulosCliente&";return e+=$("#formSearch").serialize()}getParameterProcesarArticulos(){let e="action=procesarArticulosCliente&usuario="+$("#usuario").val()+"&cod_cliente="+$("#cod_cliente").val();for(let a=0;a<articulos.length;a++)0!=$("#cod_articulo-"+articulos[a].cod_articulo).val()&&(e+="&cod_articulo-"+articulos[a].cod_articulo+"="+$("#cod_articulo-"+articulos[a].cod_articulo).val());return e}evalInputsCantidades(){let e=[];e.success=!0,e.errores=[];for(let a=0;a<articulos.length;a++)validateCantidad($("#cod_articulo-"+articulos[a].cod_articulo).val())||(e.success=!1,e.errores.push(articulos[a].cod_articulo+" - "+articulos[a].nombre));return e}getTextErrorCantidades(e){let a="<strong>Los siguientes articulos tienen un formato de cantidades incorrectas</strong><br>";for(let r=0;r<e.length;r++)a+=e[r];return a}}function esTexto(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esLetra(e[r])||(a=!1,r=e.length);else a=!1;return a}function esTextoNumero(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esLetra(e[r])||esNumeros(e[r])||(a=!1,r=e.length);else a=!1;return a}function esTextoEspacio(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esLetra(e[r])||esEspacio(e[r])||(a=!1,r=e.length);else a=!1;return a}function esNumeroMas(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esNumero(e[r])||esMas(e[r])||(a=!1,r=e.length);else a=!1;return a}function esNumeroGuion(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esNumero(e[r])||esGuion(e[r])||(a=!1,r=e.length);else a=!1;return a}function esNumeros(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esNumero(e[r])||(a=!1,r=e.length);else a=!1;return a}function esTextoEspacioPuntoComaBarraNumero(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esTexto(e[r])||esEspacio(e[r])||esPunto(e[r])||esComa(e[r])||esNumero(e[r])||esBarra(e[r])||(a=!1,r=e.length);else a=!1;return a}function esTextoPunto(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esTexto(e[r])||esPunto(e[r])||(a=!1,r=e.length);else a=!1;return a}function esTextoBarra(e){let a=!0;if(""!==e&&null!==e)for(let r=0;r<e.length;r++)esTexto(e[r])||esPunto(e[r])||(a=!1,r=e.length);else a=!1;return a}function esNumeroPositivoEntero(e){return parseInt(e)&&esPositivo(e)&&esEntero(e)}function esLetra(e){return e.charCodeAt()>64&&e.charCodeAt()<91||165===e.charCodeAt()||164===e.charCodeAt()||e.charCodeAt()>96&&e.charCodeAt()<123}function esEspacio(e){return 32===e.charCodeAt()}function esNumero(e){return e.charCodeAt()>47&&e.charCodeAt()<58}function esPositivo(e){return parseInt(e)>0}function esEntero(e){return parseInt(e)%1==0}function esGuion(e){return 45===e.charCodeAt()}function esPunto(e){return 46===e.charCodeAt()}function esComa(e){return 44===e.charCodeAt()}function esContBarra(e){return 47===e.charCodeAt()}function esBarra(e){return 92===e.charCodeAt()}function esMas(e){return 43===e.charCodeAt()}function msjDanger(e,a){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="danger" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-danger"><h1>'+e+'</h1></div><div class="modal-body">'+a+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#danger").modal("show")}function msjWarning(e,a){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="warning" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-warning"><h1>'+e+'</h1></div><div class="modal-body">'+a+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#warning").modal("show")}function msjSucces(e,a){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="success" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-success"><h1>'+e+'</h1></div><div class="modal-body">'+a+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#success").modal("show")}function msjInfo(e,a){$("#mensajes").append('<div class="modal fade bd-example-modal-lg" id="info" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header modal-header-info"><h1>'+e+'</h1></div><div class="modal-body">'+a+'</div><div class="modal-footer"><button type="button" class="btn btn-default pull-rigth" data-dismiss="modal">Cerrar</button></div></div></div></div>'),$("#info").modal("show")}function msjClean(){$("#mensajes").empty()}function cleanTbody(){$("#tbody").empty()}function enableProcesar(){$("#procesar").attr("disabled",!1)}function disableProcesar(){$("#procesar").attr("disabled",!0)}function injectArcitulos(e){for(let a=0;a<e.length;a++)$("#tbody").append("<tr><td>"+e[a].cod_articulo+"</td><td>"+e[a].nombre+"</td><td>"+e[a].descripcion+"</td><td>"+e[a].precio+"</td><td>"+e[a].descuento+"</td><td>"+e[a].iva+'</td><td><input type="number"  id="cod_articulo-'+e[a].cod_articulo+'" name="cod_articulo-'+e[a].cod_articulo+'" min="0" step="1" value="0"></td></tr>')}function search(){msjClean(),ajaxApp.callController(realizarPedidosClienteApp.getParameterSearchArticulos(),"callBackSearchArticulos")}function callBackSearchArticulos(e){e.success?(cleanTbody(),0!==e.articulos.length?(injectArcitulos(articulos=e.articulos),enableProcesar()):(disableProcesar(),articulos="")):msjDanger("SEARCH ARTICULO",e.errores[0].errMessage)}function evalCantidades(){msjClean();let e=realizarPedidosClienteApp.evalInputsCantidades();e.success?ajaxApp.callController(realizarPedidosClienteApp.getParameterProcesarArticulos(),"callBackEvalCantidades"):msjDanger("PROCESAR",realizarPedidosClienteApp.getTextErrorCantidades(e.errores))}function callBackEvalCantidades(e){e.success?msjSucces("PROCESAR","<strong>Se han procesado correctamente sus pedidos</strong>"):msjDanger("PROCESAR",e.errores[0].errMessage)}function validateCantidad(e){return esNumeroPositivoEntero(e)}var realizarPedidosClienteApp=new RealizarPedidosCliente,ajaxApp=new Ajax,articulos="";function addEventsRealizarPedidos(){$("#search").click(search),$("#procesar").click(evalCantidades)}document.onload=addEventsRealizarPedidos();